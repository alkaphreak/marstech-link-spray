```mermaid
graph TB
    %% Styles
    classDef triggerClass fill:#28a745,stroke:#1e7e34,color:#fff,stroke-width:3px
    classDef inputClass fill:#ffc107,stroke:#e0a800,stroke-width:2px
    classDef processClass fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    classDef jreleaserClass fill:#e7e7ff,stroke:#6f42c1,stroke-width:2px
    classDef successClass fill:#28a745,stroke:#1e7e34,color:#fff,stroke-width:2px
    classDef failClass fill:#dc3545,stroke:#bd2130,color:#fff,stroke-width:2px
    classDef decisionClass fill:#17a2b8,stroke:#117a8b,color:#fff,stroke-width:2px

    %% Main Flow
    START([ğŸš€ GitHub Actions<br/>Release Workflow<br/>TRIGGER]):::triggerClass
    INPUT[ğŸ‘¤ User Selects<br/>Version Bump Type]:::inputClass
    CHOICE{Version<br/>Bump?}:::decisionClass

    PATCH[PATCH<br/>0.0.4 â†’ 0.0.5<br/>Bug fixes]
    MINOR[MINOR<br/>0.0.4 â†’ 0.1.0<br/>New features]
    MAJOR[MAJOR<br/>0.0.4 â†’ 1.0.0<br/>Breaking changes]

    CHECKOUT[ğŸ“¦ Checkout Code<br/>from main branch]:::processClass
    JAVA[â˜• Setup Java 21<br/>Temurin + Maven Cache]:::processClass
    BUMP[ğŸ”¢ Bump Version<br/>./dev-ops/bump-version.sh<br/>Update pom.xml]:::processClass
    BRANCH[ğŸŒ¿ Create Release Branch<br/>release/v VERSION]:::processClass
    BUILD[ğŸ”¨ Build & Test<br/>mvn clean verify]:::processClass

    TEST{Tests<br/>Pass?}:::decisionClass

    JRELEASER[ğŸ“‹ JReleaser<br/>full-release]:::jreleaserClass

    TAG[ğŸ·ï¸ Create Git Tag<br/>v VERSION]:::jreleaserClass
    CHANGELOG[ğŸ“ Generate Changelog<br/>From commits]:::jreleaserClass
    GHRELEASE[ğŸ‰ Create GitHub Release<br/>Upload JAR artifacts]:::jreleaserClass
    DOCKER[ğŸ³ Build Docker Image<br/>marstech-link-spray]:::jreleaserClass
    DOCKERPUSH[ğŸ“¤ Push to Docker Hub<br/>Tags: version + latest]:::jreleaserClass

    MAINUPDATE[ğŸ”„ Update Main Branch<br/>Next dev version<br/>VERSION+1-SNAPSHOT]:::processClass

    SUCCESS[âœ… RELEASE COMPLETE<br/>â€¢ GitHub Release Created<br/>â€¢ Docker Images Published<br/>â€¢ Main Branch Updated]:::successClass
    FAILURE[âŒ WORKFLOW FAILED<br/>Check logs & retry]:::failClass

    %% Flow
    START --> INPUT
    INPUT --> CHOICE
    CHOICE -->|patch| PATCH
    CHOICE -->|minor| MINOR
    CHOICE -->|major| MAJOR

    PATCH --> CHECKOUT
    MINOR --> CHECKOUT
    MAJOR --> CHECKOUT

    CHECKOUT --> JAVA
    JAVA --> BUMP
    BUMP --> BRANCH
    BRANCH --> BUILD
    BUILD --> TEST

    TEST -->|âœ“ Yes| JRELEASER
    TEST -->|âœ— No| FAILURE

    JRELEASER --> TAG
    TAG --> CHANGELOG
    CHANGELOG --> GHRELEASE
    GHRELEASE --> DOCKER
    DOCKER --> DOCKERPUSH
    DOCKERPUSH --> MAINUPDATE
    MAINUPDATE --> SUCCESS

    %% Notes
    ENV[ğŸ” Required Secrets:<br/>â€¢ GITHUB_TOKEN<br/>â€¢ DOCKER_HUB_USERNAME<br/>â€¢ DOCKER_HUB_ACCESS_TOKEN]

    ARTIFACTS[ğŸ“¦ Release Artifacts:<br/>â€¢ JAR file<br/>â€¢ Docker images<br/>â€¢ Release notes<br/>â€¢ Checksums]

    START -.-> ENV
    SUCCESS -.-> ARTIFACTS
```

# MarsTech Link Spray - Release Workflow

## Quick Visual Guide

This diagram shows the automated GitHub Actions release workflow for MarsTech Link Spray.

### Workflow Steps

1. **ğŸš€ Trigger**: Manually start the release workflow in GitHub Actions
2. **ğŸ‘¤ Input**: Select version bump type (patch, minor, or major)
3. **ğŸ“¦ Checkout**: Clone the repository from main branch
4. **â˜• Setup**: Configure Java 21 and Maven environment
5. **ğŸ”¢ Bump**: Automatically update version in pom.xml
6. **ğŸŒ¿ Branch**: Create a release branch (e.g., `release/v0.0.5`)
7. **ğŸ”¨ Build**: Run `mvn clean verify` to build and test
8. **ğŸ“‹ JReleaser**: Execute release automation:
   - Create Git tag
   - Generate changelog from commits
   - Create GitHub release
   - Build Docker image
   - Push to Docker Hub
9. **ğŸ”„ Update**: Bump main branch to next development version
10. **âœ… Complete**: Release is live!

### Version Bump Types

- **PATCH** (0.0.4 â†’ 0.0.5): Bug fixes, documentation, security patches
- **MINOR** (0.0.4 â†’ 0.1.0): New features, enhancements
- **MAJOR** (0.0.4 â†’ 1.0.0): Breaking changes

### Required Configuration

Before first release, set these GitHub Secrets:
- `GITHUB_TOKEN` (automatically provided)
- `DOCKER_HUB_USERNAME`
- `DOCKER_HUB_ACCESS_TOKEN`

### Output Artifacts

Each release produces:
- âœ… GitHub Release with changelog
- âœ… JAR artifact: `mt-link-spray-[VERSION].jar`
- âœ… Docker image: `username/marstech-link-spray:v[VERSION]`
- âœ… Docker image: `username/marstech-link-spray:latest`
- âœ… Checksums and release notes

---

**View this diagram:**
- On GitHub: The Mermaid diagram renders automatically
- In IDE: Use Mermaid preview plugins
- Online: Copy to [Mermaid Live Editor](https://mermaid.live/)

**For more details, see:**
- [RELEASE_GUIDE.md](../RELEASE_GUIDE.md) - Complete release documentation
- [release-workflow.dot](release-workflow.dot) - Detailed Graphviz diagram

